<?xml version="1.0" encoding="UTF-8"?>
<solution xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="3dValidator.xsd" 
          companyName="ISEL" 
          projectName="Sample">
	<!--Dominio de tipos-->
	<userTypes>
    <string name="nomePessoa" length="100"></string>
    <DateTime name="dtNascimentoPessoa"></DateTime>
    <string name="nifPessoa" pattern="[0-9]{9}"></string>
    <int name="numeroEmpregado" minInclusive="1" maxInclusive="2000"></int>
    <DateTime name="dtAdmissaoEmpregado"></DateTime>
    <int name="litrosCombustivelManager" minInclusive="0" maxInclusive="100"></int>
    <double name="limiteCartaoCreditoDirector" minExclusive="0" maxInclusive="1500"></double>
    <string name="nomeDepartamentoDirectorPrimeiraLinha" length="100"></string>
    <int name="antiguidadeDirectorSegundaLinha" minInclusive="0" maxInclusive="35"></int>
    <double name="creditoMaximoCliente" minExclusive="0" maxInclusive="15000"></double>
    <string name="horaInicioCalendario" pattern="[0-9]{2}:[0-9]{2}" length="5"/>
    <string name="horaFimCalendario" pattern="[0-9]{2}:[0-9]{2}" length="5"/>
    <string name="salaCalendario" length="10"/>
    <string name="nomeDocente" length="100"></string>
    <string name="nomeDisciplina" length="100"></string>
    <string name="nomeTurma" length="100"></string>
    <string name="nomeCurso" length="100"></string>
    <int name="numeroDocente" minExclusive="1" maxInclusive="99999"></int>
    <int name="anoAno" minInclusive="2010" maxInclusive="2070"></int>
    <string name="semestreAno" length="10" >
      <enumeration>Inverno</enumeration>
      <enumeration>Verao</enumeration>
    </string>
    <string name="nomePerson" length="100"></string>
    <string name="nomeBlog" length="100"></string>
    <string name="namePost" length="100"></string>
    <string name="contentComment" length="100"></string>
    <DateTime name="createPost"/>
    <DateTime name="createComment"/>
    <int name="identificador" maxInclusive="5000"/>
		<string name="nomeArtista" length="100"/>
		<string name="pais" maxLength="3" pattern="[A-Z]{3}"/>
		<string name="tituloAlbum" maxLength="100"/>
    <DateTime name="dataEdicaoLP"/>
    <DateTime name="DtLancamentoEP"/>    
    <string name="generoMusical">
			<enumeration>Rock</enumeration>
			<enumeration>Pop</enumeration>
			<enumeration>Reggae</enumeration>
			<enumeration>Blues</enumeration>
			<enumeration>Jazz</enumeration>
			<enumeration>Classica</enumeration>
		</string>
		<string name="nomeMusica" length="100"/>
		<string name="tempoMusica" pattern="[0-9]{2}:[0-9]{2}"/>
		<int name="anoColectanea"/>
		<string name="patrocinadorColectanea"/>
		<string name="nomeEditor" maxLength="50"/>
    <string name="tipoAlbum">
      <enumeration>LP</enumeration>
      <enumeration>EP</enumeration>
    </string>
    <int name="encomendaQtd" minInclusive="1" maxInclusive="100"></int>
    <string name="canalVendas">
      <enumeration>LOJA</enumeration>
      <enumeration>WEB</enumeration>
    </string>
    <int name="idCliente" minExclusive="0" maxInclusive="9999999"/>
    <string name="idEncomenda" length="20"></string>
    <string name="estadoEncomenda">
      <enumeration>Registada</enumeration>
      <enumeration>Tramitada</enumeration>
      <enumeration>Esgotada</enumeration>
      <enumeration>Enviada</enumeration>
      <enumeration>Anulada</enumeration>
      <enumeration>Cancelada</enumeration>
      <enumeration>Concluida</enumeration>
    </string>
    <string name="retornoCancelarEncomenda">
      <enumeration>Cancelada</enumeration>
      <enumeration>EstadoInvalido</enumeration>
      <enumeration>PendenteCancelamento</enumeration>
    </string>
    <string name="userName"></string>
    <string name="password"></string>
    <string name="nomeCompleto"></string>
    <DateTime name="dtNascimento"></DateTime>
    <string name="retornoAlteracaoPassword">
      <enumeration>Sucesso</enumeration>
      <enumeration>UtilizadorInvalido</enumeration>
      <enumeration>UtilizadorBloqueado</enumeration>
    </string>
    <string name="nomeLoja" length="100"></string>
	</userTypes>
	
  <!--Servidores de BD-->
	<environments>
		<dataEnvironments>
			<provider name="FirstBDServer" type="MsSql2005" connectionString="Server=127.0.0.1;Initial Catalog=iselsample;User Id=iselsample;Password=iselsample;" serverName="127.0.0.1" instance="SQLSERVER1" username="iselsample" password="iselsample" catalog="iselsample"/>
		</dataEnvironments>
	</environments>
  
  <businessProcesses>
    <component name="Venda">      
      <businessProcess name="EncomendaCliente" description="Processo generico de encomenda">
        <input>
          <param type="tipoAlbum" name="tipoAlbum" minOccurs="1" maxOccurs="1"></param>
          <param type="identificador" name="idAlbum" minOccurs="1" maxOccurs="1"></param>
          <param type="canalVendas" name="canal" minOccurs="1" maxOccurs="1"></param>
          <param type="idCliente" name="idCliente" minOccurs="1" maxOccurs="1"></param>
          <param type="encomendaQtd" name="encomendaQtd" minOccurs="1" maxOccurs="1"></param>          
        </input> <!-- unbounded -->
        <output type="idEncomenda" minOccurs="1" maxOccurs="1"/>
      </businessProcess>

      <businessProcess name="ObterEstadoEncomenda" description="Verificação do estado da encomenda">
        <input>
          <param type="idEncomenda" name="idEncomenda" minOccurs="1" maxOccurs="1"></param>
        </input>
        <!-- unbounded -->
        <output type="estadoEncomenda" minOccurs="1" maxOccurs="1"/>
      </businessProcess>

      <businessProcess name="CancelarEncomenda" description="Cancelamento de encomenda">
        <input>
          <param type="idEncomenda" name="idEncomenda" minOccurs="1" maxOccurs="1"></param>
        </input>
        <!-- unbounded -->
        <output type="retornoCancelarEncomenda" minOccurs="1" maxOccurs="1"/>
      </businessProcess>
      
    </component>

    <component name="Registo">
      <businessProcess name="RegistoCliente" description="Processo generico de registo de cliente">
        <input>
          <param type="userName" name="userName" minOccurs="1" maxOccurs="1"></param>
          <param type="password" name="password" minOccurs="1" maxOccurs="1"></param>
          <param type="nomeCompleto" name="nomeCompleto" minOccurs="1" maxOccurs="1"></param>
          <param type="dtNascimento" name="dtNascimento" minOccurs="1" maxOccurs="1"></param>
        </input>
        <!-- unbounded -->
        <output type="idCliente" minOccurs="1" maxOccurs="1"/>
      </businessProcess>

      <businessProcess name="AlteracaoPassword" description="Processo de alteração de password">
        <input>
          <param type="userName" name="userName" minOccurs="1" maxOccurs="1"></param>
          <param type="password" name="passwordActual" minOccurs="1" maxOccurs="1"></param>
          <param type="password" name="passwordFutura" minOccurs="1" maxOccurs="1"></param>
        </input>
        <!-- unbounded -->
        <output type="retornoAlteracaoPassword" minOccurs="1" maxOccurs="1"/>
      </businessProcess>

    </component>
   
    </businessProcesses>

	<!--Definição de entidades-->
	<entities>

    <entity type="abstract" name="Pessoa">
      <fields>
        <field type="nomePessoa" name="Nome"/>
        <field type="dtNascimentoPessoa" name="DtNascimento"/>
        <field type="nifPessoa" name="NIF" />
      </fields>
    </entity>

    <entity type="abstractdependent" name="Empregado" baseEntity="Pessoa">
      <fields>
        <field type="numeroEmpregado" name="Numero"/>
        <field type="dtAdmissaoEmpregado" name="DtAdmissao"/>
      </fields>
    </entity>

    <entity type="dependent" name="Manager" baseEntity="Empregado">
      <fields>
        <field type="litrosCombustivelManager" name="LitrosCombustivel"/>
      </fields>
    </entity>

    <entity type="abstractdependent" name="Director" baseEntity="Empregado">
      <fields>
        <field type="limiteCartaoCreditoDirector" name="LimiteCartaoCredito"/>
      </fields>
    </entity>

    <entity type="dependent" name="DirectorPrimeiraLinha" baseEntity="Director">
      <fields>
        <field type="nomeDepartamentoDirectorPrimeiraLinha" name="NomeDepartamento"/>
      </fields>
    </entity>

    <entity type="dependent" name="DirectorSegundaLinha" baseEntity="Director">
      <fields>
        <field type="antiguidadeDirectorSegundaLinha" name="Antiguidade" nillable="true"/>
      </fields>
    </entity>

    <entity type="dependent" name="Cliente" baseEntity="Pessoa">
      <fields>
        <field type="creditoMaximoCliente" name="CreditoMaximo" nillable="true"/>
      </fields>
    </entity>

    <entity type="base" name="Calendario">
      <fields>
        <field type="horaInicioCalendario" name="HoraInicio" nillable="true"/>
        <field type="horaFimCalendario" name="HoraFim" nillable="true"/>
        <field type="salaCalendario"   name="Sala" nillable="true"/>
      </fields>
    </entity>

    <entity type="base" name="Docente">
      <fields>
        <field type="nomeDocente" name="Nome"/>
        <field type="numeroDocente" name="Numero"/>
      </fields>
    </entity>

    <entity type="base" name="Ano">
      <fields>
        <field type="anoAno" name="Ano"/>
        <field type="semestreAno" name="Semestre"/>
      </fields>
    </entity>
      
    <entity type="base" name="Disciplina">
      <fields>
        <field type="nomeDisciplina" name="Nome"/>
      </fields>
    </entity>

    <entity type="base" name="Turma">
      <fields>
        <field type="nomeTurma" name="Nome"/>
      </fields>
    </entity>

    <entity type="base" name="Curso">
      <fields>
        <field type="nomeCurso" name="Nome"/>
      </fields>
    </entity>
    
    <entity type="base" name="Person">
      <fields>
        <field type="nomePerson" name="Nome"/>
      </fields>
    </entity>

    <entity type="base" name="Blog">
      <fields>
        <field type="nomeBlog" name="Nome"/>
      </fields>
    </entity>

    <entity type="base" name="Post">
      <fields>
        <field type="namePost" name="Name"/>
        <field type="createPost" name="Create"/>
      </fields>
    </entity>

    <entity type="base" name="Comment">
      <fields>
        <field type="contentComment" name="Content"/>
        <field type="createComment" name="Create"/>
      </fields>
    </entity>

    <!-- Entidade base Editor(idEditor, nome, pais) Relação 1-* com Album-->
		<entity type="base" name="Editor">
		  <fields>
			  <field type="nomeEditor" name="Nome"/>
			  <field type="pais" name="Pais"/>
		  </fields>
		</entity>
	
		<!-- Entidade Abstracta Album(idAlbum, titulo) Relação 1-1 com Editor-->
		<entity type="abstract" name="Album">
		  <fields>
			  <field type="tituloAlbum" name="Titulo"/>
		  </fields>
		</entity>
	
		<!-- Entidade dependente de Album, LP(dtEdicao) Relação 1-* com Faixa-->
		<entity type="dependent" name="LP" baseEntity="Album">
		  <fields>
			  <field type="dataEdicaoLP" name="DtEdicao"/>
		  </fields>
		</entity>
	
		<!-- Entidade dependent de Album, EP() Relação 1-* com Faixa-->
		<entity type="dependent" name="EP" baseEntity="Album">
      <fields>
        <field type="dataEdicaoLP" name="DtLancamento"/>
      </fields>
    </entity>

    <!-- Entidade base Faixa(nome, duracao, genero) -->
    <entity type="base" name="Faixa">
      <fields>
        <field type="nomeMusica" name="Nome"/>
        <field type="tempoMusica" name="Duracao"/>
        <field type="generoMusical" name="Genero"/>
      </fields>
    </entity>

    <!-- Entidade base Interprete(nome, nacionalidade) Relação 1-* com Album-->
		<entity type="base" name="Interprete">
			<fields>
				<field type="nomeArtista" name="Nome"/>
				<field type="pais" name="Nacionalidade"/>
			</fields>
		</entity>

    <!-- Entidade base Faixa(nome, duracao, genero) -->
    <entity type="base" name="Loja">
      <fields>
        <field type="nomeLoja" name="Nome"/>
      </fields>
    </entity>

    <relations>
      <!-- Empty Relations ( Sample ) -->
      <!--
        <relation type="OneToOne" name="" baseEntity="" extendedEntity="" minOccurs="1" maxOccurs="1"></relation>
        <relation type="OneToMany" name="" oneEntity="" manyEntity="" nillable="" minOccurs="1" maxOccurs="1" inverse="true|false"></relation>
        <relation type="ManyToOne" name="" manyEntity="" oneEntity="" nillable="" minOccurs="1" maxOccurs="1" inverse="true|false"></relation>
        <relation type="ManyToMany" entityName="" minOccurs="1" maxOccurs="unbounded">
          <entity name="" nillable="" inverse="true|false" relationName=""/>
        </relation>
      -->
           
      <relation type="OneToMany" name="Albuns" oneEntity="Editor" manyEntity="Album" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="true"></relation>
      <relation type="OneToMany" name="Albuns" oneEntity="Interprete" manyEntity="Album" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="false"></relation>
      <relation type="OneToMany" name="Faixas" oneEntity="LP" manyEntity="Faixa" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="true"></relation>
      <relation type="OneToMany" name="Faixas" oneEntity="EP" manyEntity="Faixa" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="true"></relation>

      <relation type="OneToMany" name="Comments" oneEntity="Post" manyEntity="Comment" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="true"></relation>
      <relation type="ManyToOne" name="Owner" manyEntity="Blog" oneEntity="Person" nillable="false" minOccurs="1" maxOccurs="1" inverse="false"></relation>
      <relation type="OneToMany" name="Posts" oneEntity="Blog" manyEntity="Post" nillable="false" minOccurs="1" maxOccurs="unbounded" inverse="false"></relation>

      <relation type="ManyToOne" name="Curso" manyEntity="Turma" oneEntity="Curso" nillable="false" minOccurs="1" maxOccurs="1" inverse="true"></relation>      
      <relation type="ManyToMany" entityName="Calendario" minOccurs="1" maxOccurs="unbounded">
        <entity name="Docente" nillable="false" inverse="true" relationName="Lecciona"/>
        <entity name="Ano" nillable="false" inverse="false"/>
        <entity name="Disciplina" nillable="false" inverse="false"/>
        <entity name="Turma" nillable="false" inverse="false"/>
      </relation>

    </relations>


  </entities>
</solution>
